

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Text Normalization (Chinese) &#8212; Python Notes for Linguistics</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-dropdown.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Machine Learning with Sci-Kit Learn" href="sklearn.html" />
    <link rel="prev" title="Text Normalization (English)" href="text-normalization-eng.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/ntnu03.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Python Notes for Linguistics</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../python-basics/python-basics.html">
   Python Basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../corpus/corpus-processing.html">
   Corpus Linguistics with Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../statistical-analyses/statistical-analyses.html">
   Statistical Analyses
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="reference internal" href="nlp.html">
   Natural Language Processing with Python
  </a>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="nlp-spacy.html">
     Natural Language Processing (spaCy)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nlp-spacy-zh.html">
     Chinese Natural Language Processing (spaCy)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nlp-ckipnlp.html">
     Natural Language Processing (ckipnlp)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="text-normalization-eng.html">
     Text Normalization (English)
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Text Normalization (Chinese)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sklearn.html">
     Machine Learning with Sci-Kit Learn
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="naive-bayes.html">
     Naive Bayes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sentiment-analysis-ml.html">
     Sentiment Analysis with Traditional Machine Learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="word-embeddings.html">
     Word Embeddings
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="word2vec-chinese.html">
     Word Embeddings with Chinese Texts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="word2vec.html">
     Word2Vec
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="doc2vec.html">
     Dov2Vec
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sentiment-analysis-dl.html">
     Sentiment Analysis with Deep Learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sentiment-analysis-lstm-v1.html">
     Sentiment Analysis with LSTM
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="seq-to-seq.html">
     Machine Translation (Sequence-to-Sequence LSTM)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="text-gen-lstm-v1.html">
     Text Generation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="transfer-learning-sent-encoding.html">
     Universal Sentence Embeddings
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="hyperparameter-tuning.html">
     Hyper-Parameter Tuning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sentiment-analysis-using-bert-chinese.html">
     Sentiment Analysis Using BERT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ktrain-tutorial-explaining-predictions.html">
     Explainable AI
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../appendix/todo.html">
   To-do List
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  <div style="text-align:left">
    <a href="https://alvinchen.myftp.org/" target='_blank'>Alvin Chen's Homepage</a>
</div>

</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/nlp/text-normalization-chinese.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/alvinntnu/python-notes/master?urlpath=tree/nlp/text-normalization-chinese.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/alvinntnu/python-notes/blob/master/nlp/text-normalization-chinese.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#normalization-functions">
   Normalization Functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#extract-an-article">
   Extract an Article
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="text-normalization-chinese">
<h1>Text Normalization (Chinese)<a class="headerlink" href="#text-normalization-chinese" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">text_normalizer_zh.py</span></code></p></li>
<li><p>Including functions for:</p>
<ul>
<li><p>word-seg chinese texts</p></li>
<li><p>clean up texts by removing duplicate spaces and line breaks</p></li>
<li><p>remove incompatible weird characters</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">unicodedata</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="c1">#from nltk.corpus import wordnet</span>
<span class="c1">#import collections</span>
<span class="kn">from</span> <span class="nn">nltk.tokenize.toktok</span> <span class="kn">import</span> <span class="n">ToktokTokenizer</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">text_normalizer_zh</span> <span class="k">as</span> <span class="nn">tnz</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="normalization-functions">
<h2>Normalization Functions<a class="headerlink" href="#normalization-functions" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># %load text_normalizer_zh.py</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">Notes</span>
<span class="sd">-----</span>

<span class="sd">    These functions are based on the text normalization functions </span>
<span class="sd">    provided in Text Analytics with Python 2ed.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">unicodedata</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="c1"># from nltk.tokenize.toktok import ToktokTokenizer</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">jieba</span>

<span class="c1">## Initialize Trad Chinese dictionary</span>
<span class="n">jieba</span><span class="o">.</span><span class="n">set_dictionary</span><span class="p">(</span><span class="s1">&#39;../../../RepositoryData/data/jiaba/dict.txt.jiebatw.txt&#39;</span><span class="p">)</span>


<span class="c1">## Normalize unicode characters</span>
<span class="k">def</span> <span class="nf">remove_weird_chars</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="c1">#     ```</span>
    <span class="c1">#     (NFKD) will apply the compatibility decomposition, i.e.</span>
    <span class="c1">#     replace all compatibility characters with their equivalents.</span>
    <span class="c1">#     ```</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">unicodedata</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="s1">&#39;NFKD&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span>
                                                      <span class="s1">&#39;ignore&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span>
                                                          <span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">text</span>


<span class="c1">## Remove extra linebreaks</span>
<span class="k">def</span> <span class="nf">remove_extra_linebreaks</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\n+&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[\s]+&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lines</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">])</span>


<span class="c1">## Remove extra medial/trailing/leading spaces</span>
<span class="k">def</span> <span class="nf">remove_extra_spaces</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">s+&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>


<span class="c1">## Seg the text into words</span>
<span class="k">def</span> <span class="nf">seg</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="n">text_seg</span> <span class="o">=</span> <span class="n">jieba</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="n">out</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">text_seg</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">out</span>


<span class="c1">## Remove punctuation/symbols</span>
<span class="k">def</span> <span class="nf">remove_symbols</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    </span>
<span class="sd">    Unicode 6.0 has 7 character categories, and each category has subcategories:</span>

<span class="sd">    Letter (L): lowercase (Ll), modifier (Lm), titlecase (Lt), uppercase (Lu), other (Lo)</span>
<span class="sd">    Mark (M): spacing combining (Mc), enclosing (Me), non-spacing (Mn)</span>
<span class="sd">    Number (N): decimal digit (Nd), letter (Nl), other (No)</span>
<span class="sd">    Punctuation (P): connector (Pc), dash (Pd), initial quote (Pi), final quote (Pf), open (Ps), close (Pe), other (Po)</span>
<span class="sd">    Symbol (S): currency (Sc), modifier (Sk), math (Sm), other (So)</span>
<span class="sd">    Separator (Z): line (Zl), paragraph (Zp), space (Zs)</span>
<span class="sd">    Other (C): control (Cc), format (Cf), not assigned (Cn), private use (Co), surrogate (Cs)</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    There are 3 ranges reserved for private use (Co subcategory): </span>
<span class="sd">    U+E000—U+F8FF (6,400 code points), U+F0000—U+FFFFD (65,534) and U+100000—U+10FFFD (65,534). </span>
<span class="sd">    Surrogates (Cs subcategory) use the range U+D800—U+DFFF (2,048 code points).</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">## Brute-force version: list all possible unicode ranges, but this list is not complete.</span>
    <span class="c1">#   text = re.sub(&#39;[\u0021-\u002f\u003a-\u0040\u005b-\u0060\u007b-\u007e\u00a1-\u00bf\u2000-\u206f\u2013-\u204a\u20a0-\u20bf\u2100-\u214f\u2150-\u218b\u2190-\u21ff\u2200-\u22ff\u2300-\u23ff\u2460-\u24ff\u2500-\u257f\u2580-\u259f\u25a0-\u25ff\u2600-\u26ff\u2e00-\u2e7f\u3000-\u303f\ufe50-\ufe6f\ufe30-\ufe4f\ufe10-\ufe1f\uff00-\uffef─◆╱]+&#39;,&#39;&#39;,text)</span>

    <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ch</span> <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">text</span>
                   <span class="k">if</span> <span class="n">unicodedata</span><span class="o">.</span><span class="n">category</span><span class="p">(</span><span class="n">ch</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">text</span>


<span class="c1">## Remove numbers</span>
<span class="k">def</span> <span class="nf">remove_numbers</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">d+&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>


<span class="c1">## Remove alphabets</span>
<span class="k">def</span> <span class="nf">remove_alphabets</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;[a-zA-Z]+&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>


<span class="c1">## Combine every step</span>
<span class="k">def</span> <span class="nf">normalize_corpus</span><span class="p">(</span><span class="n">corpus</span><span class="p">,</span>
                     <span class="n">is_remove_extra_linebreaks</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                     <span class="n">is_remove_weird_chars</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                     <span class="n">is_seg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                     <span class="n">is_remove_symbols</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                     <span class="n">is_remove_numbers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                     <span class="n">is_remove_alphabets</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>

    <span class="n">normalized_corpus</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># normalize each document in the corpus</span>
    <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">corpus</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">is_remove_extra_linebreaks</span><span class="p">:</span>
            <span class="n">doc</span> <span class="o">=</span> <span class="n">remove_extra_linebreaks</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">is_remove_weird_chars</span><span class="p">:</span>
            <span class="n">doc</span> <span class="o">=</span> <span class="n">remove_weird_chars</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">is_seg</span><span class="p">:</span>
            <span class="n">doc</span> <span class="o">=</span> <span class="n">seg</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">is_remove_symbols</span><span class="p">:</span>
            <span class="n">doc</span> <span class="o">=</span> <span class="n">remove_symbols</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">is_remove_alphabets</span><span class="p">:</span>
            <span class="n">doc</span> <span class="o">=</span> <span class="n">remove_alphabets</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">is_remove_numbers</span><span class="p">:</span>
            <span class="n">doc</span> <span class="o">=</span> <span class="n">remove_numbers</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

        <span class="n">normalized_corpus</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">remove_extra_spaces</span><span class="p">(</span><span class="n">doc</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">normalized_corpus</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="extract-an-article">
<h2>Extract an Article<a class="headerlink" href="#extract-an-article" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Grab the first article from Google news for demonstration</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://news.google.com/topics/CAAqJQgKIh9DQkFTRVFvSUwyMHZNRFptTXpJU0JYcG9MVlJYS0FBUAE?hl=zh-TW&amp;gl=TW&amp;ceid=TW%3Azh-Hant&#39;</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">web_content</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span>
<span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">web_content</span><span class="p">,</span> <span class="s1">&#39;lxml&#39;</span><span class="p">)</span>
<span class="n">title</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s1">&#39;DY5T1d&#39;</span><span class="p">)</span>
<span class="n">first_art_link</span> <span class="o">=</span> <span class="n">title</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;href&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;https://news.google.com&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1">#print(first_art_link)</span>
<span class="n">art_request</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">first_art_link</span><span class="p">)</span>
<span class="n">art_request</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span>
<span class="n">soup_art</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">art_request</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s1">&#39;lxml&#39;</span><span class="p">)</span>

<span class="n">art_content</span> <span class="o">=</span> <span class="n">soup_art</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="n">art_texts</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">text</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">art_content</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">art_texts</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;2018年10月21日，台鐵發生普悠瑪號列車翻覆事故，到今天正好屆滿2周年。據悉，交通部長林佳龍日前主動要求台鐵進行安全報告，不料竟赫然發現，今年5月19日台鐵台中成功站南側，竟因斷軌44公分卻通報不實，讓莒光號及普悠瑪號兩班列車高速通過斷軌處，險再釀重大事故。更離譜的是，該處早在2個月前已出現裂痕卻遲遲未處理，讓林佳龍當場震怒，痛斥台鐵「沒有最扯，只有更扯！」、「兩年前這麼多無辜的生命，不能白白犧牲！」&#39;, &#39;相關新聞：台鐵App出包！旅客買了自強號看不到座位\u3000悲情一路站到目的地&#39;, &#39;交通部回應表示，林佳龍已要求台鐵檢討，懲處名單報部核定，提高懲處層級，包括局長在內，一併全面檢討相關責任。&#39;, &#39;林佳龍在2019年初上任交通部長後，要求針對普悠瑪列車翻覆事故重啟調查、擴大懲處、提高賠償，家屬陸續接受賠償條件。據了解，今年事故周年紀念前夕，林佳龍要求台鐵局、鐵道局、路政司等單位，向他彙報台鐵的安全策進作為，原是希望藉此激勵台鐵提高安全管理，豈料卻因得知519事故經過而大怒。&#39;, &#39;運安會曾在今年5月30日發布「安全通告」，要求台鐵對全台的彎道鋼軌加強檢查，當時曾指出台鐵5月19日發生內軌斷裂、所幸無人傷亡，但並未對外透露事發詳細經過。交通部5月19日當天雖接獲台鐵簡訊通報有鋼軌事故，但稍晚即已緊急修復，恢復雙向通行。&#39;, &#39;不過據《蘋果》掌握消息，林佳龍日前主動要求台鐵報告時，台鐵才首度向交通部坦言，今年5月19日晚間18時59分，台鐵第3218次司機員向成功站通報：「鐵軌碰一聲很大聲，好像是斷軌。」站務人員通知道班後共同前往查看，但竟然未依SOP向調度員通報，導致後續有兩班列車包括2次莒光號、288次普悠瑪自強號，高速通過該地點。直到調度員自行從無線電群組聽到成功站的通話，得知有鋼軌斷裂，才在19時27分發布行車命令封鎖該線，改單線雙向行車，過程相當驚險。&#39;, &#39;隨後成功道班趕至現場緊急搶修，發現鋼軌斷裂44公分，先以1公尺短軌緊急更換，21時26分完成搶修才恢復雙線行車，當晚收班後再連夜換新鋼軌。隔天台鐵通報運安會立案調查，也才有10天之後的安全通告。&#39;, &#39;據了解，台鐵追查後發現，成功道班領班早在今年3月3日，就發現該處鋼軌出現裂紋，發現後及通知相關人員處理，進行臨時補強措施；依標準作業程序，當晚就應該抽換新的鋼軌，不料相關人員竟置之不理，此案就此石沉大海，直到5月19日因司機員察覺有異進通報，才發現事態嚴重，兩個多月來的行車安全猶如「命繫一軌」。&#39;, &#39;據與會者透露，林佳龍聽完報告後，對於台鐵事前未積極防範、事發未確實通報、事後未主動向交通部專案報告等情形極為不滿，對於發現鋼軌裂痕竟然石沈大海兩個多月更是痛罵「離譜至極！」會中更罕見地措詞強硬質問台鐵：「普悠瑪翻覆事故快兩周年了，這樣叫做有記取教訓嗎？」&#39;, &#39;知情人士也透露，林佳龍在會中說，怕的不只是一個斷軌沒有處理好，而是如果沒有痛定思痛，下次不知道哪一段斷軌會發生更大的事故，「顯示台鐵的改革根本不及格！」他要求台鐵提高懲處層級，也要針對相關疏失、以及運安會要求加強全台鋼軌安全檢測的作為，進行相關檢討報告。&#39;, &#39;台鐵人員表示，3月時發現軌道有裂痕，並非沒有處理，現場人員先採魚尾鈑夾住加固，考量當時現場有其他工程正在施作，現場人員規劃先抽換道岔後，再來更換新鋼軌，導致時間拖比較久，該案目前運安會已經立案調查。&#39;, &#39;交通部回應表示，根據台鐵就519斷軌事件初步調查情形，涉及鋼軌檢修、突發通報、安全管理等疏失，台鐵日前報告後，部長有五點指示，第一、台鐵務必全力配合運安會調查，誠實為上策，如再有隱瞞，絕不寬貸；第二、懲處名單報部核定，提高懲處層級，包括局長在內，一併全面檢討相關責任。&#39;, &#39;第三、林佳龍要求針對519事件成立檢討專案，檢視鋼軌檢修作業流程及通報機制，並落實相關人員布達及訓練；四、針對運安會要求對全台的彎道鋼軌加強檢查，台鐵應於最快時間內完成，並向交通部及運安會報告檢修及改善情形；五、只有安全，才有台鐵，台鐵務必記取教訓、痛定思痛，否則難以重建人民信任。此案目前正由運安會調查，交通部及台鐵局將全力配合調查。（李姿慧／台北報導）&#39;]
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Normalized results:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tnz</span><span class="o">.</span><span class="n">normalize_corpus</span><span class="p">([</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">art_texts</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Building prefix dict from /Users/Alvin/GoogleDrive/_MySyncDrive/RepositoryData/data/jiaba/dict.txt.jiebatw.txt ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dumping model to file cache /var/folders/n7/ltpzwx813c599nfxfb94s_640000gn/T/jieba.u1b52b47246a0f2e6497af6bbe107adac.cache
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loading model cost 2.027 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Prefix dict has been built successfully.
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;年 月 日 台鐵 發生 普悠瑪號 列車 翻覆 事故 到 今天 正好 屆滿 周年 據悉 交通部長 林佳龍 日前 主動 要求 台鐵 進行 安全 報告 不料 竟 赫然 發現 今年 月 日 台鐵 台中 成功 站 南側 竟因 斷軌 公分 卻 通報 不實 讓 莒光號 及 普悠瑪號 兩班 列車 高速 通過 斷軌 處 險 再 釀 重大 事故 更 離譜 的 是 該處 早 在 個 月 前 已 出現 裂痕 卻 遲遲 未 處理 讓 林佳龍 當場 震怒 痛斥 台鐵 沒有 最扯 只有 更 扯 兩年 前 這麼多 無辜 的 生命 不能 白白 犧牲 相關 新聞 台鐵 出包 旅客 買 了 自強號 看不到 座位 悲情 一路 站到 目的地 交通部 回應 表示 林佳龍 已 要求 台鐵 檢討 懲處 名單 報部 核定 提高 懲處 層級 包括 局長 在內 一併 全面 檢討 相關 責任 林佳龍 在 年初 上任 交通部長 後 要求 針對 普悠瑪 列車 翻覆 事故 重啟 調查 擴大 懲處 提高 賠償 家屬 陸續 接受 賠償 條件 據了解 今年 事故 周年 紀念 前夕 林佳龍 要求 台鐵局 鐵道局 路政司 等 單位 向 他 彙報 台鐵 的 安全 策進 作為 原是 希望 藉 此 激勵 台鐵 提高 安全 管理 豈料 卻 因 得知 事故 經過 而 大怒 運安會 曾 在 今年 月 日 發布 安全 通告 要求 台鐵 對 全台 的 彎道 鋼軌 加強 檢查 當時 曾 指出 台鐵 月 日 發生 內軌 斷裂 所幸 無 人 傷亡 但 並未 對外 透露 事發 詳細 經過 交通部 月 日 當天 雖 接獲 台鐵 簡訊 通報 有 鋼軌 事故 但 稍 晚 即已 緊急 修復 恢復 雙向 通行 不過 據 蘋果 掌握 消息 林佳龍 日前 主動 要求 台鐵 報告 時 台鐵 才 首度 向 交通部 坦言 今年 月 日 晚間 時 分 台鐵 第 次 司機員 向 成功 站 通報 鐵軌 碰一聲 很 大聲 好像 是 斷軌 站務 人員 通知 道班 後 共同 前往 查看 但 竟然 未依 向 調度員 通報 導致 後續 有 兩班 列車 包括 次 莒光號 次 普悠瑪 自強號 高速 通過 該 地點 直到 調度員 自行 從 無線電 群組 聽到 成功 站 的 通話 得知 有 鋼軌 斷裂 才 在 時 分 發布 行車 命令 封鎖 該線 改 單線 雙向 行車 過程 相當 驚險 隨後 成功 道班 趕至 現場 緊急 搶修 發現 鋼軌 斷裂 公分 先以 公尺 短軌 緊急 更換 時 分 完成 搶修 才 恢復 雙線 行車 當晚 收班 後 再 連夜 換新 鋼軌 隔天 台鐵 通報 運安會 立案 調查 也 才 有 天 之後 的 安全 通告 據了解 台鐵 追查 後 發現 成功 道班 領班 早 在 今年 月 日 就 發現 該處 鋼軌 出現 裂紋 發現 後 及 通知 相關 人員 處理 進行 臨時 補強 措施 依 標準 作業 程序 當晚 就 應該 抽換 新 的 鋼軌 不料 相關 人員 竟 置之不理 此案 就此 石沉 大海 直到 月 日因 司機員 察覺 有異 進 通報 才 發現 事態 嚴重 兩個 多 月 來 的 行車 安全 猶如 命 繫 一 軌 據 與會 者 透露 林佳龍 聽完 報告 後 對於 台鐵 事前 未 積極 防範 事發 未 確實 通報 事後未 主動 向 交通部 專案 報告 等 情形 極為 不滿 對於 發現 鋼軌 裂痕 竟然 石沈大海 兩個 多 月 更 是 痛罵 離譜 至極 會 中 更 罕見 地 措詞 強硬 質問 台鐵 普悠瑪 翻覆 事故 快 兩 周年 了 這樣 叫做 有 記取 教訓 嗎 知情 人士 也 透露 林佳龍 在 會 中 說 怕 的 不 只是 一個 斷軌 沒有 處理好 而是 如果 沒有 痛定思痛 下次 不 知道 哪 一段 斷軌 會 發生 更大 的 事故 顯示 台鐵 的 改革 根本 不 及格 他 要求 台鐵 提高 懲處 層級 也 要 針對 相關 疏失 以及 運安會 要求 加強 全台 鋼軌 安全 檢測 的 作為 進行 相關 檢討 報告 台鐵 人員 表示 月 時 發現 軌道 有 裂痕 並非 沒有 處理 現場 人員 先採 魚尾 鈑 夾住 加固 考量 當時 現場 有 其 他 工程 正在 施作 現場 人員 規劃 先 抽換 道岔 後 再來 更換 新 鋼軌 導致 時間 拖 比較 久 該 案 目前 運安會 已經 立案 調查 交通部 回應 表示 根據 台鐵 就 斷軌 事件 初步 調查 情形 涉及 鋼軌 檢修 突發 通報 安全 管理 等 疏失 台鐵 日前 報告 後 部長 有五點 指示 第一 台鐵 務必 全力 配合 運安會 調查 誠實 為 上策 如 再 有 隱瞞 絕不 寬貸 第二 懲處 名單 報部 核定 提高 懲處 層級 包括 局長 在內 一併 全面 檢討 相關 責任 第三 林佳龍 要求 針對 事件 成立 檢討 專案 檢視 鋼軌 檢修 作業 流程 及 通報 機制 並 落實 相關 人員 布達 及 訓練 四 針對 運安會 要求 對 全台 的 彎道 鋼軌 加強 檢查 台鐵 應 於 最快 時間 內 完成 並向 交通部 及 運安會 報告 檢修 及 改善 情形 五 只有 安全 才 有 台鐵 台鐵 務必 記取 教訓 痛定思痛 否則 難以 重建 人民 信任 此案 目前 正由 運安會 調查 交通部 及 台鐵局 將 全力 配合 調查 李姿慧 台北 報導&#39;]
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python-notes",
            path: "./nlp"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python-notes'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="text-normalization-eng.html" title="previous page">Text Normalization (English)</a>
    <a class='right-next' id="next-link" href="sklearn.html" title="next page">Machine Learning with Sci-Kit Learn</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Alvin Chen<br/>
        
            &copy; Copyright 2020 Alvin Chen.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../_static/js/index.js"></script>
    
  </body>
</html>