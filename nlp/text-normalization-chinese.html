

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Text Normalization (Chinese) &#8212; Python Notes for Linguistics</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mycss.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-dropdown.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Machine Learning with Sci-Kit Learn" href="sklearn.html" />
    <link rel="prev" title="Text Normalization (English)" href="text-normalization-eng.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/ntnu03.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Python Notes for Linguistics</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../python-basics/python-basics.html">
   Python Basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../corpus/corpus-processing.html">
   Corpus Linguistics with Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../statistical-analyses/statistical-analyses.html">
   Statistical Analyses
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="reference internal" href="nlp.html">
   Natural Language Processing with Python
  </a>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="nlp-spacy.html">
     Natural Language Processing (spaCy)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nlp-spacy-zh.html">
     Chinese Natural Language Processing (spaCy)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nlp-ckipnlp.html">
     Natural Language Processing (ckipnlp)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="text-normalization-eng.html">
     Text Normalization (English)
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Text Normalization (Chinese)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sklearn.html">
     Machine Learning with Sci-Kit Learn
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="naive-bayes.html">
     Naive Bayes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sentiment-analysis-ml.html">
     Sentiment Analysis with Traditional Machine Learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="neural-network-from-scratch.html">
     Neural Network From Scratch
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="neural-language-model-primer.html">
     Neural Language Model: A Start
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="word-embeddings.html">
     Word Embeddings
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="word2vec-chinese.html">
     Word Embeddings with Chinese Texts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="word2vec.html">
     Word2Vec
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="doc2vec.html">
     Dov2Vec
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sentiment-analysis-dl.html">
     Sentiment Analysis with Deep Learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sentiment-analysis-lstm-v1.html">
     Sentiment Analysis with LSTM
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="seq-to-seq.html">
     Machine Translation (Sequence-to-Sequence LSTM)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="text-gen-lstm-v1.html">
     Text Generation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="transfer-learning-sent-encoding.html">
     Universal Sentence Embeddings
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="hyperparameter-tuning.html">
     Hyper-Parameter Tuning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sentiment-analysis-using-bert-chinese.html">
     Sentiment Analysis Using BERT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ktrain-tutorial-explaining-predictions.html">
     Explainable AI
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../appendix/todo.html">
   To-do List
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  <div style="text-align:left">
    <a href="https://alvinchen.myftp.org/" target='_blank'>Alvin Chen's Homepage</a>
</div>

</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/nlp/text-normalization-chinese.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/alvinntnu/python-notes/master?urlpath=tree/nlp/text-normalization-chinese.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/alvinntnu/python-notes/blob/master/nlp/text-normalization-chinese.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#normalization-functions">
   Normalization Functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#extract-an-article">
   Extract an Article
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="text-normalization-chinese">
<h1>Text Normalization (Chinese)<a class="headerlink" href="#text-normalization-chinese" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">text_normalizer_zh.py</span></code></p></li>
<li><p>Including functions for:</p>
<ul>
<li><p>word-seg chinese texts</p></li>
<li><p>clean up texts by removing duplicate spaces and line breaks</p></li>
<li><p>remove incompatible weird characters</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">unicodedata</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="c1">#from nltk.corpus import wordnet</span>
<span class="c1">#import collections</span>
<span class="kn">from</span> <span class="nn">nltk.tokenize.toktok</span> <span class="kn">import</span> <span class="n">ToktokTokenizer</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">text_normalizer_zh</span> <span class="k">as</span> <span class="nn">tnz</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="normalization-functions">
<h2>Normalization Functions<a class="headerlink" href="#normalization-functions" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># %load text_normalizer_zh.py</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">Notes</span>
<span class="sd">-----</span>

<span class="sd">    These functions are based on the text normalization functions </span>
<span class="sd">    provided in Text Analytics with Python 2ed.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">unicodedata</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="c1"># from nltk.tokenize.toktok import ToktokTokenizer</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">jieba</span>

<span class="c1">## Initialize Trad Chinese dictionary</span>
<span class="n">jieba</span><span class="o">.</span><span class="n">set_dictionary</span><span class="p">(</span><span class="s1">&#39;../../../RepositoryData/data/jiaba/dict.txt.jiebatw.txt&#39;</span><span class="p">)</span>


<span class="c1">## Normalize unicode characters</span>
<span class="k">def</span> <span class="nf">remove_weird_chars</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="c1">#     ```</span>
    <span class="c1">#     (NFKD) will apply the compatibility decomposition, i.e.</span>
    <span class="c1">#     replace all compatibility characters with their equivalents.</span>
    <span class="c1">#     ```</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">unicodedata</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="s1">&#39;NFKD&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span>
                                                      <span class="s1">&#39;ignore&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span>
                                                          <span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">text</span>


<span class="c1">## Remove extra linebreaks</span>
<span class="k">def</span> <span class="nf">remove_extra_linebreaks</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\n+&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[\s]+&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lines</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">])</span>


<span class="c1">## Remove extra medial/trailing/leading spaces</span>
<span class="k">def</span> <span class="nf">remove_extra_spaces</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">s+&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>


<span class="c1">## Seg the text into words</span>
<span class="k">def</span> <span class="nf">seg</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="n">text_seg</span> <span class="o">=</span> <span class="n">jieba</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="n">out</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">text_seg</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">out</span>


<span class="c1">## Remove punctuation/symbols</span>
<span class="k">def</span> <span class="nf">remove_symbols</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    </span>
<span class="sd">    Unicode 6.0 has 7 character categories, and each category has subcategories:</span>

<span class="sd">    Letter (L): lowercase (Ll), modifier (Lm), titlecase (Lt), uppercase (Lu), other (Lo)</span>
<span class="sd">    Mark (M): spacing combining (Mc), enclosing (Me), non-spacing (Mn)</span>
<span class="sd">    Number (N): decimal digit (Nd), letter (Nl), other (No)</span>
<span class="sd">    Punctuation (P): connector (Pc), dash (Pd), initial quote (Pi), final quote (Pf), open (Ps), close (Pe), other (Po)</span>
<span class="sd">    Symbol (S): currency (Sc), modifier (Sk), math (Sm), other (So)</span>
<span class="sd">    Separator (Z): line (Zl), paragraph (Zp), space (Zs)</span>
<span class="sd">    Other (C): control (Cc), format (Cf), not assigned (Cn), private use (Co), surrogate (Cs)</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    There are 3 ranges reserved for private use (Co subcategory): </span>
<span class="sd">    U+E000—U+F8FF (6,400 code points), U+F0000—U+FFFFD (65,534) and U+100000—U+10FFFD (65,534). </span>
<span class="sd">    Surrogates (Cs subcategory) use the range U+D800—U+DFFF (2,048 code points).</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">## Brute-force version: list all possible unicode ranges, but this list is not complete.</span>
    <span class="c1">#   text = re.sub(&#39;[\u0021-\u002f\u003a-\u0040\u005b-\u0060\u007b-\u007e\u00a1-\u00bf\u2000-\u206f\u2013-\u204a\u20a0-\u20bf\u2100-\u214f\u2150-\u218b\u2190-\u21ff\u2200-\u22ff\u2300-\u23ff\u2460-\u24ff\u2500-\u257f\u2580-\u259f\u25a0-\u25ff\u2600-\u26ff\u2e00-\u2e7f\u3000-\u303f\ufe50-\ufe6f\ufe30-\ufe4f\ufe10-\ufe1f\uff00-\uffef─◆╱]+&#39;,&#39;&#39;,text)</span>

    <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ch</span> <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">text</span>
                   <span class="k">if</span> <span class="n">unicodedata</span><span class="o">.</span><span class="n">category</span><span class="p">(</span><span class="n">ch</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">text</span>


<span class="c1">## Remove numbers</span>
<span class="k">def</span> <span class="nf">remove_numbers</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">d+&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>


<span class="c1">## Remove alphabets</span>
<span class="k">def</span> <span class="nf">remove_alphabets</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;[a-zA-Z]+&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>


<span class="c1">## Combine every step</span>
<span class="k">def</span> <span class="nf">normalize_corpus</span><span class="p">(</span><span class="n">corpus</span><span class="p">,</span>
                     <span class="n">is_remove_extra_linebreaks</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                     <span class="n">is_remove_weird_chars</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                     <span class="n">is_seg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                     <span class="n">is_remove_symbols</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                     <span class="n">is_remove_numbers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                     <span class="n">is_remove_alphabets</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>

    <span class="n">normalized_corpus</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># normalize each document in the corpus</span>
    <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">corpus</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">is_remove_extra_linebreaks</span><span class="p">:</span>
            <span class="n">doc</span> <span class="o">=</span> <span class="n">remove_extra_linebreaks</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">is_remove_weird_chars</span><span class="p">:</span>
            <span class="n">doc</span> <span class="o">=</span> <span class="n">remove_weird_chars</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">is_seg</span><span class="p">:</span>
            <span class="n">doc</span> <span class="o">=</span> <span class="n">seg</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">is_remove_symbols</span><span class="p">:</span>
            <span class="n">doc</span> <span class="o">=</span> <span class="n">remove_symbols</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">is_remove_alphabets</span><span class="p">:</span>
            <span class="n">doc</span> <span class="o">=</span> <span class="n">remove_alphabets</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">is_remove_numbers</span><span class="p">:</span>
            <span class="n">doc</span> <span class="o">=</span> <span class="n">remove_numbers</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

        <span class="n">normalized_corpus</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">remove_extra_spaces</span><span class="p">(</span><span class="n">doc</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">normalized_corpus</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="extract-an-article">
<h2>Extract an Article<a class="headerlink" href="#extract-an-article" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Grab the first article from Google news for demonstration</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://news.google.com/topics/CAAqJQgKIh9DQkFTRVFvSUwyMHZNRFptTXpJU0JYcG9MVlJYS0FBUAE?hl=zh-TW&amp;gl=TW&amp;ceid=TW%3Azh-Hant&#39;</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">web_content</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span>
<span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">web_content</span><span class="p">,</span> <span class="s1">&#39;lxml&#39;</span><span class="p">)</span>
<span class="n">title</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s1">&#39;DY5T1d&#39;</span><span class="p">)</span>
<span class="n">first_art_link</span> <span class="o">=</span> <span class="n">title</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;href&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;https://news.google.com&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1">#print(first_art_link)</span>
<span class="n">art_request</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">first_art_link</span><span class="p">)</span>
<span class="n">art_request</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span>
<span class="n">soup_art</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">art_request</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s1">&#39;lxml&#39;</span><span class="p">)</span>

<span class="n">art_content</span> <span class="o">=</span> <span class="n">soup_art</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="n">art_texts</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">text</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">art_content</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">art_texts</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;&#39;, &#39;\n&#39;, &#39;\n&#39;, &#39;\n&#39;, &#39;\r\n國民黨台南市議員謝龍介和民進黨台中市議員謝志忠，今年年初因為立法委員選情互賭，謝龍介賭輸，今天到台中市豐原葫蘆墩公園準備跳河履行承諾。&#39;, &#39;\n&#39;, &#39;\r\n他今天在跳水前接受媒體採訪，針對NCC昨天公聽會要審查中天換照公聽會，謝龍介，不要有用民粹殺死媒體 ，他這等於是公審方式，對任何媒體都不可以這樣做，他說每個媒體可能都不盡大家滿意，也不可能和所有人民立場一樣。&#39;, &#39;\n&#39;, &#39;\r\n謝龍介說， 這種公聽會方式為了服務執政黨，不符合言論自由的真義，他說昨天的公聽會是錯誤的示範， 否則將來每個媒體要換照是否都要直播， 讓立場不同的人來撻伐。&#39;, &#39;\n&#39;, &#39;\r\n謝龍介認為媒體應該回歸市場機制 ，讓市場決定媒體是否有能力存在經營， 他說這樣民主發展才可長可久， 這是我們奮鬥幾十年來得來不易的言論自由，他要NCC緊急煞車。台南市議員謝龍介今天下午，要在台中市豐原葫蘆墩公園跳水還賭約。記者游振昇/攝影&#39;, &#39;\n&#39;, &#39;\n&#39;, &#39;\n                    國民黨台南市議員謝龍介和民進黨台中市議員謝志忠，今年年初因為立法委員選情互賭，謝龍介賭輸，今天到台中市豐原葫蘆墩公園準備...                  &#39;, &#39;\n                    針對10月26日中天新聞台換照聽證會，前立委孫大千在臉書表示，以聽證內容來看，顯然鑑定人已經有了預設立場，這根本就是一場...                  &#39;, &#39;\n                    國家通訊傳播委員會昨天舉辦中天新聞台換照聽證會，7位受邀鑑定人一面倒認為中天有缺失。國民黨立委賴士葆在臉書批評，他同意台...                  &#39;, &#39;\n                    中天電視台換照議題，是否衝擊蔡政府？財團法人台灣民意基金會上午公布最新民調顯示，有三成三民眾樂見中天電視台被撤照，五成三...                  &#39;, &#39;\n                    民進黨台北市議員王世堅自振興三倍券後，屢屢槓上行政院長蘇貞昌，日前指蘇「不只想當行政院長」，這次中天換照案，王世堅也暗指...                  &#39;, &#39;\n                    中天這次能否順利換照，其實，民進黨政府承受極大的壓力，因為關或不關閉這家新聞台，都會得罪另一群人，所以大家都在猜，蔡政府最後怎麼選擇？結果又將如何？                  &#39;, &#39;\n                    國家通訊傳播委員會（ＮＣＣ）昨天針對中天新聞台申請換照案舉行聽證會，聲援中天的前新聞局長鍾琴與「公民監督平台」在立法院外...                  &#39;, &#39;\n                    旺中董事長蔡衍明昨天以中天新聞台大股東神旺投資負責人名義，親上火線出席中天新聞台換照聽證會，他撇清自己不會控管新聞，「我...                  &#39;, &#39;\n                    國家通訊傳播委員會（ＮＣＣ）昨天召開中天電視台換照案聽證會，現場委員聚焦在新聞室內控與人事調度議題，詢問中天電視新聞部總...                  &#39;, &#39;\n                    眾所矚目的中天新聞台換照案，國家通訊傳播委員會（ＮＣＣ）昨天首度召開聽證會，議程破紀錄長達八個多小時，鑑定人質疑中天未履...                  &#39;, &#39;\n                    民進黨發言人顏若芳今天指出，中天換照是媒體依法接受NCC專業審查的程序，NCC是獨立機關，相信會依照法規及專業，對審查電...                  &#39;, &#39;\n                    今天NCC 舉行中天換照案的聽證會，會議對外直播，讓我們可以一窺NCC委員對中天新聞台的各種質疑與批判，其中一個令我印象深刻的問題是NCC委員詢問中天，一位編審是否每天有看完每一則中天推出的報導？藉此要凸顯中天的內控可能有問題。                  &#39;, &#39;\n&#39;, &#39;\n&#39;, &#39;\n&#39;, &#39;\n&#39;, &#39;\n&#39;, &#39;\n&#39;]
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Normalized results:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tnz</span><span class="o">.</span><span class="n">normalize_corpus</span><span class="p">([</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">art_texts</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Building prefix dict from /Users/Alvin/GoogleDrive/_MySyncDrive/RepositoryData/data/jiaba/dict.txt.jiebatw.txt ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loading model from cache /var/folders/n7/ltpzwx813c599nfxfb94s_640000gn/T/jieba.u1b52b47246a0f2e6497af6bbe107adac.cache
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loading model cost 0.572 seconds.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Prefix dict has been built successfully.
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;國民黨 台南 市議員 謝龍介 和 民進黨 台中市 議員 謝志忠 今年 年初 因為 立法 委員 選情 互賭 謝龍介 賭輸 今天 到 台中市 豐原 葫蘆墩 公園 準備 跳河 履行 承諾 他 今天 在 跳水 前 接受 媒體 採訪 針對 昨天 公聽會 要 審查 中天 換照 公聽會 謝龍介 不要 有用 民粹 殺死 媒體 他 這 等於 是 公審 方式 對 任何 媒體 都 不可以 這樣 做 他 說 每個 媒體 可能 都 不盡 大家 滿意 也 不可能 和 所有 人民 立場 一樣 謝龍介 說 這種 公聽會 方式 為了 服務 執政黨 不 符合 言論 自由 的 真義 他 說 昨天 的 公聽會 是 錯誤 的 示範 否則 將來 每個 媒體 要 換照 是否 都 要 直播 讓 立場 不同 的 人來 撻伐 謝龍介 認為 媒體 應該 回歸 市場 機制 讓 市場 決定 媒體 是否 有 能力 存在 經營 他 說 這樣 民主 發展 才 可長 可久 這是 我們 奮鬥 幾十年 來得 來 不易 的 言論 自由 他 要 緊急 煞車 台南 市議員 謝龍介 今天 下午 要 在 台中市 豐原 葫蘆墩 公園 跳水 還賭 約 記者 游振 昇 攝影 國民黨 台南 市議員 謝龍介 和 民進黨 台中市 議員 謝志忠 今年 年初 因為 立法 委員 選情 互賭 謝龍介 賭輸 今天 到 台中市 豐原 葫蘆墩 公園 準備 針對 月 日 中天 新聞台 換照 聽證會 前立委 孫大千 在 臉書 表示 以 聽證 內容 來 看 顯然 鑑定人 已經 有 了 預設 立場 這 根本 就是 一場 國家 通訊 傳播 委員會 昨天 舉辦 中天 新聞台 換照 聽證會 位 受邀 鑑定人 一面倒 認為 中天 有 缺失 國民黨 立委 賴士葆 在 臉書 批評 他 同意 台 中天 電視台 換照 議題 是否 衝擊 蔡 政府 財團 法人 台灣 民意 基金會 上午 公布 最 新 民調 顯示 有三成 三 民眾 樂見 中天 電視台 被 撤照 五成 三 民進黨 台北 市議員 王世堅 自 振興 三倍券 後 屢屢 槓上 行政院長 蘇貞昌 日前 指蘇 不只 想當 行政院長 這次 中天 換照 案 王世堅 也 暗指 中天 這次 能否 順利 換照 其實 民進黨 政府 承受 極大 的 壓力 因為 關或 不 關閉 這家 新聞台 都 會 得罪 另 一群 人 所以 大家 都 在 猜 蔡 政府 最後 怎麼 選擇 結果 又將 如何 國家 通訊 傳播 委員會 昨天 針對 中天 新聞台 申請 換照 案 舉行 聽證會 聲援 中天 的 前新聞局長 鍾 琴 與 公民 監督 平台 在 立法院 外 旺中 董事長 蔡衍明 昨天 以 中天 新聞 台大 股東 神旺 投資 負責人 名義 親 上火線 出席 中天 新聞台 換照 聽證會 他 撇清 自己 不會 控管 新聞 我 國家 通訊 傳播 委員會 昨天 召開 中天 電視台 換照 案 聽證會 現場 委員 聚焦 在 新聞 室內 控與 人事 調度 議題 詢問 中天 電視 新聞部 總 眾所矚目 的 中天 新聞台 換照 案 國家 通訊 傳播 委員會 昨天 首度 召開 聽證會 議程 破紀錄 長達 八個 多 小時 鑑定人 質疑 中天 未履 民進黨 發言人 顏若芳 今天 指出 中天 換照 是 媒體 依法 接受 專業 審查 的 程序 是 獨立 機關 相信 會 依照 法規 及 專業 對 審查 電 今天 舉行 中天 換照 案 的 聽證會 會議 對外 直播 讓 我們 可以 一窺 委員 對 中天 新聞台 的 各種 質疑 與 批判 其中 一個 令 我 印象 深刻 的 問題 是 委員 詢問 中天 一位 編審 是否 每天 有 看完 每一則 中天 推出 的 報導 藉 此要 凸顯 中天 的 內控 可能 有 問題&#39;]
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python-notes",
            path: "./nlp"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python-notes'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="text-normalization-eng.html" title="previous page">Text Normalization (English)</a>
    <a class='right-next' id="next-link" href="sklearn.html" title="next page">Machine Learning with Sci-Kit Learn</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Alvin Chen<br/>
        
            &copy; Copyright 2020 Alvin Chen.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../_static/js/index.js"></script>
    
  </body>
</html>